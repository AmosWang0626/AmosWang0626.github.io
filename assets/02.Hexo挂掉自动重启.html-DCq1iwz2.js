import{_ as n,c as a,b as e,o as p}from"./app-DX-8M_Q1.js";const t={};function o(l,s){return p(),a("div",null,s[0]||(s[0]=[e(`<h1 id="hexo挂掉自动重启" tabindex="-1"><a class="header-anchor" href="#hexo挂掉自动重启"><span>Hexo挂掉自动重启</span></a></h1><p>使用hexo时，hexo进程总会无辜挂掉（可能是服务器内存不够），所以就需要一个能监控hexo挂掉，就自动重启的小工具。</p><p><code>npm install pm2 -g</code></p><h2 id="_1-pm2介绍" tabindex="-1"><a class="header-anchor" href="#_1-pm2介绍"><span>1. pm2介绍</span></a></h2><p><a href="https://github.com/Unitech/pm2" target="_blank" rel="noopener noreferrer">https://github.com/Unitech/pm2</a></p><p>具有内置负载均衡的的Node.js应用进程管理器。</p><h3 id="新增" tabindex="-1"><a class="header-anchor" href="#新增"><span>新增</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">pm2 start <span class="token parameter variable">--name</span> hexo /opt/hexo/auto-start-hexo.js</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="删除" tabindex="-1"><a class="header-anchor" href="#删除"><span>删除</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ delete<span class="token operator">|</span>del <span class="token operator">&lt;</span>name<span class="token operator">|</span><span class="token function">id</span><span class="token operator">|</span>namespace<span class="token operator">|</span>script<span class="token operator">|</span>all<span class="token operator">|</span>json<span class="token operator">|</span>stdin<span class="token punctuation">..</span>.<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="查询" tabindex="-1"><a class="header-anchor" href="#查询"><span>查询</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ pm2 list<span class="token operator">|</span><span class="token function">ls</span><span class="token operator">|</span>l<span class="token operator">|</span><span class="token function">ps</span><span class="token operator">|</span>status</span>
<span class="line">$ pm2 logs</span>
<span class="line">$ pm2 monit</span>
<span class="line">$ pm2 describe <span class="token operator">&lt;</span>id<span class="token operator">|</span>app_name<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line">$ pm2 stop     <span class="token operator">&lt;</span>app_name<span class="token operator">|</span>namespace<span class="token operator">|</span><span class="token function">id</span><span class="token operator">|</span><span class="token string">&#39;all&#39;</span><span class="token operator">|</span>json_conf<span class="token operator">&gt;</span></span>
<span class="line">$ pm2 restart  <span class="token operator">&lt;</span>app_name<span class="token operator">|</span>namespace<span class="token operator">|</span><span class="token function">id</span><span class="token operator">|</span><span class="token string">&#39;all&#39;</span><span class="token operator">|</span>json_conf<span class="token operator">&gt;</span></span>
<span class="line">$ pm2 delete   <span class="token operator">&lt;</span>app_name<span class="token operator">|</span>namespace<span class="token operator">|</span><span class="token function">id</span><span class="token operator">|</span><span class="token string">&#39;all&#39;</span><span class="token operator">|</span>json_conf<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-自动启动hexo脚本" tabindex="-1"><a class="header-anchor" href="#_2-自动启动hexo脚本"><span>2. 自动启动hexo脚本</span></a></h2><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">var</span> exec <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;child_process&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>exec<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> cmd <span class="token operator">=</span> <span class="token string">&#39;cd /opt/hexo/hexoui &amp;&amp; nohup hexo s &amp;&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">exec</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">if</span><span class="token punctuation">(</span>stdout<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;stdout: &#39;</span> <span class="token operator">+</span> stdout<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">if</span><span class="token punctuation">(</span>stderr<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;stderr: &#39;</span> <span class="token operator">+</span> stderr<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;start error!&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;start hexo-js success!&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">// process.exit(0);</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-用-pm2-执行如上脚本" tabindex="-1"><a class="header-anchor" href="#_3-用-pm2-执行如上脚本"><span>3. 用 pm2 执行如上脚本</span></a></h2><blockquote><p>找不到 pm2 命令？进入 node 安装目录下的 bin 目录</p></blockquote><p><code>pm2 start /app/hexo/hexo-auto.js</code></p><p><code>pm2 logs</code></p><p><code>pm2 list</code></p>`,19)]))}const i=n(t,[["render",o],["__file","02.Hexo挂掉自动重启.html.vue"]]),r=JSON.parse('{"path":"/boutique/front/02.Hexo%E6%8C%82%E6%8E%89%E8%87%AA%E5%8A%A8%E9%87%8D%E5%90%AF.html","title":"Hexo挂掉自动重启","lang":"zh-CN","frontmatter":{"title":"Hexo挂掉自动重启","date":"2020-11-17T00:00:00.000Z","categories":"前端相关","tags":["Node.js"]},"headers":[{"level":2,"title":"1. pm2介绍","slug":"_1-pm2介绍","link":"#_1-pm2介绍","children":[{"level":3,"title":"新增","slug":"新增","link":"#新增","children":[]},{"level":3,"title":"删除","slug":"删除","link":"#删除","children":[]},{"level":3,"title":"查询","slug":"查询","link":"#查询","children":[]}]},{"level":2,"title":"2. 自动启动hexo脚本","slug":"_2-自动启动hexo脚本","link":"#_2-自动启动hexo脚本","children":[]},{"level":2,"title":"3. 用 pm2 执行如上脚本","slug":"_3-用-pm2-执行如上脚本","link":"#_3-用-pm2-执行如上脚本","children":[]}],"git":{"updatedTime":1739460467000,"contributors":[{"name":"amos.wang","username":"amos.wang","email":"1833063210@qq.com","commits":1,"url":"https://github.com/amos.wang"}]},"filePathRelative":"boutique/front/02.Hexo挂掉自动重启.md"}');export{i as comp,r as data};
